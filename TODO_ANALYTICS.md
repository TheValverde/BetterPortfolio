# TODO: Analytics & User Interaction Tracking

## Overview
Implement comprehensive analytics to track user interactions, chat conversations, and project visits to gain insights into portfolio engagement and user behavior.

## Database Schema

### 1. User Sessions Table
```sql
CREATE TABLE user_sessions (
  id SERIAL PRIMARY KEY,
  session_id VARCHAR(255) UNIQUE NOT NULL,
  ip_address INET,
  user_agent TEXT,
  referrer TEXT,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  last_activity TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  session_duration INTEGER, -- in seconds
  page_views INTEGER DEFAULT 0
);
```

### 2. Chat Conversations Table
```sql
CREATE TABLE chat_conversations (
  id SERIAL PRIMARY KEY,
  session_id VARCHAR(255) REFERENCES user_sessions(session_id),
  conversation_id VARCHAR(255) UNIQUE NOT NULL,
  started_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  ended_at TIMESTAMP,
  message_count INTEGER DEFAULT 0,
  conversation_summary TEXT, -- Generated by LM Studio
  conversation_classification VARCHAR(100), -- e.g., 'job_inquiry', 'technical_question', 'general_chat'
  satisfaction_rating INTEGER CHECK (satisfaction_rating >= 1 AND satisfaction_rating <= 5),
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### 3. Chat Messages Table
```sql
CREATE TABLE chat_messages (
  id SERIAL PRIMARY KEY,
  conversation_id VARCHAR(255) REFERENCES chat_conversations(conversation_id),
  message_type VARCHAR(20) NOT NULL, -- 'user' or 'assistant'
  content TEXT NOT NULL,
  timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  message_length INTEGER,
  contains_question BOOLEAN DEFAULT FALSE,
  contains_contact_request BOOLEAN DEFAULT FALSE
);
```

### 4. Project Views Table
```sql
CREATE TABLE project_views (
  id SERIAL PRIMARY KEY,
  session_id VARCHAR(255) REFERENCES user_sessions(session_id),
  project_id INTEGER REFERENCES projects(id),
  viewed_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  time_spent INTEGER, -- in seconds
  scroll_depth INTEGER, -- percentage of page scrolled
  clicked_demo BOOLEAN DEFAULT FALSE,
  clicked_source BOOLEAN DEFAULT FALSE,
  clicked_live_site BOOLEAN DEFAULT FALSE
);
```

### 5. Page Views Table
```sql
CREATE TABLE page_views (
  id SERIAL PRIMARY KEY,
  session_id VARCHAR(255) REFERENCES user_sessions(session_id),
  page_path VARCHAR(500) NOT NULL,
  page_title VARCHAR(255),
  viewed_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  time_spent INTEGER, -- in seconds
  exit_page BOOLEAN DEFAULT FALSE
);
```

### 6. Resume Downloads Table
```sql
CREATE TABLE resume_downloads (
  id SERIAL PRIMARY KEY,
  session_id VARCHAR(255) REFERENCES user_sessions(session_id),
  resume_filename VARCHAR(255) NOT NULL,
  downloaded_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  download_source VARCHAR(100), -- 'header_button', 'ai_chat', 'contact_section'
  ip_address INET
);
```

## LM Studio Integration

### 1. Conversation Summarization
- **Endpoint**: `/api/analytics/summarize-conversation`
- **Input**: Full conversation text
- **Output**: Structured summary with key topics, user intent, and satisfaction indicators
- **Frequency**: After each conversation ends

### 2. FAQ Classification
- **Endpoint**: `/api/analytics/classify-faq`
- **Input**: Individual messages or conversation summaries
- **Output**: Classification tags (e.g., 'technical_question', 'job_inquiry', 'project_interest')
- **Frequency**: Real-time for new messages

### 3. Sentiment Analysis
- **Endpoint**: `/api/analytics/analyze-sentiment`
- **Input**: User messages
- **Output**: Sentiment score and confidence level
- **Frequency**: Real-time for user messages

## Analytics Dashboard

### 1. Real-time Metrics
- Active users
- Current conversations
- Page views per minute
- Popular projects
- Chat response times

### 2. Historical Reports
- Daily/weekly/monthly user engagement
- Most viewed projects
- Common FAQ topics
- User journey analysis
- Conversion rates (visitor â†’ contact)

### 3. AI Insights
- Trending conversation topics
- User satisfaction trends
- Most effective project presentations
- Common user pain points
- Optimization recommendations

## Implementation Phases

### Phase 1: Basic Tracking
- [ ] User session tracking
- [ ] Page view logging
- [ ] Project view tracking
- [ ] Resume download tracking

### Phase 2: Chat Analytics
- [ ] Conversation logging
- [ ] Message tracking
- [ ] Basic conversation metrics

### Phase 3: LM Studio Integration
- [ ] Conversation summarization
- [ ] FAQ classification
- [ ] Sentiment analysis

### Phase 4: Advanced Analytics
- [ ] User journey mapping
- [ ] A/B testing framework
- [ ] Predictive analytics
- [ ] Automated insights

## Privacy & Compliance

### Data Collection
- [ ] GDPR compliance
- [ ] Cookie consent
- [ ] Data retention policies
- [ ] Anonymization options

### Security
- [ ] Data encryption
- [ ] Access controls
- [ ] Audit logging
- [ ] Regular backups

## Technical Requirements

### Dependencies
- [ ] LM Studio API integration
- [ ] Real-time analytics library
- [ ] Data visualization tools
- [ ] Export functionality

### Performance
- [ ] Efficient database indexing
- [ ] Caching strategies
- [ ] Background processing
- [ ] Data aggregation

## Success Metrics

### Engagement
- Average session duration
- Pages per session
- Return visitor rate
- Chat completion rate

### Business Impact
- Resume download rate
- Contact form submissions
- Project demo clicks
- User satisfaction scores

### Technical Performance
- Analytics data accuracy
- Real-time processing speed
- Dashboard load times
- API response times

